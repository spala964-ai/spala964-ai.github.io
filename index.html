<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Auto Note Taker</title>
  <script src="/_sdk/data_sdk.js"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      overflow: hidden;
    }

    html {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .container {
      display: flex;
      height: 100%;
      gap: 24px;
      padding: 24px;
    }

    .input-panel {
      flex: 1;
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .notes-panel {
      flex: 1;
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    h1 {
      margin: 0 0 8px 0;
      font-size: 32px;
      font-weight: 700;
      color: #1a202c;
    }

    .subtitle {
      color: #718096;
      font-size: 14px;
      margin-bottom: 24px;
    }

    .input-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    label {
      display: block;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .title-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 16px;
      margin-bottom: 16px;
      transition: border-color 0.2s;
      font-family: inherit;
    }

    .title-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .record-controls {
      display: flex;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .record-btn {
      padding: 12px 24px;
      background: #48bb78;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
      white-space: nowrap;
    }

    .record-btn:hover:not(:disabled) {
      background: #38a169;
      transform: translateY(-1px);
    }

    .record-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .record-btn.recording {
      background: #f56565;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }

    .clear-btn {
      padding: 12px 20px;
      background: #e2e8f0;
      color: #2d3748;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .clear-btn:hover {
      background: #cbd5e0;
    }

    .recording-status {
      font-size: 14px;
      color: #4a5568;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .recording-timer {
      background: #fed7d7;
      color: #c53030;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 700;
      font-family: 'Courier New', monospace;
    }

    .mic-notice {
      background: #fef5e7;
      border-left: 4px solid #f59e0b;
      padding: 12px 16px;
      border-radius: 8px;
      margin-bottom: 16px;
      font-size: 13px;
      color: #92400e;
      display: none;
    }

    .transcript-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .transcript-input {
      flex: 1;
      width: 100%;
      padding: 16px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 15px;
      resize: none;
      font-family: inherit;
      line-height: 1.6;
      transition: all 0.2s;
      min-height: 150px;
    }

    .transcript-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .transcript-input.recording-active {
      border-color: #48bb78;
      background: #f0fff4;
    }

    .live-caption {
      background: #edf2f7;
      border: 2px solid #cbd5e0;
      border-radius: 8px;
      padding: 12px 16px;
      margin-top: 12px;
      font-size: 14px;
      color: #2d3748;
      font-style: italic;
      min-height: 60px;
      display: none;
      animation: fadeIn 0.3s;
    }

    .live-caption.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .live-caption-label {
      font-size: 11px;
      text-transform: uppercase;
      color: #718096;
      font-weight: 600;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }

    .live-caption-text {
      color: #1a202c;
      line-height: 1.5;
    }

    .word-count {
      font-size: 12px;
      color: #a0aec0;
      margin-top: 8px;
      text-align: right;
    }

    .generate-btn {
      margin-top: 16px;
      padding: 16px 32px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      font-family: inherit;
    }

    .generate-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    .generate-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .notes-list {
      flex: 1;
      overflow-y: auto;
      margin-top: 16px;
      min-height: 0;
    }

    .note-card {
      background: #f7fafc;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      border-left: 4px solid #667eea;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .note-card:hover {
      transform: translateX(4px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .note-header {
      display: flex;
      justify-content: space-between;
      align-items: start;
      margin-bottom: 12px;
    }

    .note-title {
      font-size: 18px;
      font-weight: 700;
      color: #1a202c;
      margin: 0;
    }

    .note-date {
      font-size: 12px;
      color: #a0aec0;
    }

    .note-section {
      margin-top: 12px;
    }

    .section-label {
      font-size: 12px;
      font-weight: 600;
      color: #667eea;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 8px;
    }

    .bullet-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .bullet-list li {
      padding-left: 20px;
      position: relative;
      margin-bottom: 6px;
      color: #4a5568;
      font-size: 14px;
      line-height: 1.5;
    }

    .bullet-list li:before {
      content: "‚Ä¢";
      position: absolute;
      left: 6px;
      color: #667eea;
      font-weight: bold;
    }

    .action-item {
      background: #fef5e7;
      border-left: 3px solid #f59e0b;
      padding: 8px 12px;
      margin-bottom: 6px;
      border-radius: 4px;
      font-size: 14px;
      color: #92400e;
    }

    .delete-btn {
      background: #fc8181;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
      transition: background 0.2s;
      font-family: inherit;
    }

    .delete-btn:hover {
      background: #f56565;
    }

    .empty-state {
      text-align: center;
      color: #a0aec0;
      padding: 60px 20px;
      font-size: 16px;
    }

    .loading {
      opacity: 0.6;
      pointer-events: none;
    }

    @media (max-width: 968px) {
      .container {
        flex-direction: column;
        overflow-y: auto;
        height: auto;
        min-height: 100%;
      }

      .input-panel, .notes-panel {
        flex: none;
        min-height: 400px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="input-panel">
    <h1 id="app-title">Auto Note Taker</h1>
    <p class="subtitle">Record or paste your transcript and let AI organize your notes</p>
    <div class="input-section"><label for="note-title">Meeting Title</label> <input type="text" id="note-title" class="title-input" placeholder="e.g., Team Standup - Jan 15">
     <div class="record-controls"><button id="record-btn" class="record-btn">üé§ Start Recording</button> <button id="clear-btn" class="clear-btn">Clear</button> <span id="recording-status" class="recording-status"></span>
     </div>
     <div id="mic-notice" class="mic-notice"></div><label for="transcript">Transcript</label>
     <div class="transcript-container"><textarea id="transcript" class="transcript-input" placeholder="Paste your meeting transcript here... or use the microphone to record"></textarea>
      <div id="live-caption" class="live-caption">
       <div class="live-caption-label">
        üéôÔ∏è Live Caption
       </div>
       <div id="live-caption-text" class="live-caption-text">
        Listening...
       </div>
      </div>
      <div id="word-count" class="word-count">
       0 words
      </div>
     </div><button id="generate-btn" class="generate-btn">Generate Notes</button>
    </div>
   </div>
   <div class="notes-panel">
    <h1>Your Notes</h1>
    <p class="subtitle">All your organized meeting notes</p>
    <div id="notes-list" class="notes-list">
     <div class="empty-state" id="empty-state">
      No notes yet. Paste a transcript to get started!
     </div>
    </div>
   </div>
  </div>
  <script>
    let allNotes = [];
    let recognition = null;
    let isRecording = false;
    let currentTranscript = '';
    let recordingStartTime = null;
    let timerInterval = null;
    
    const defaultConfig = {
      app_title: "Auto Note Taker",
      input_placeholder: "Paste your meeting transcript here...",
      generate_button_text: "Generate Notes",
      empty_state_text: "No notes yet. Paste a transcript to get started!"
    };

    // Data SDK handler
    const dataHandler = {
      onDataChanged(data) {
        allNotes = data;
        renderNotes();
      }
    };

    // Element SDK implementation
    async function onConfigChange(config) {
      const appTitle = config.app_title || defaultConfig.app_title;
      const inputPlaceholder = config.input_placeholder || defaultConfig.input_placeholder;
      const generateButtonText = config.generate_button_text || defaultConfig.generate_button_text;
      const emptyStateText = config.empty_state_text || defaultConfig.empty_state_text;

      document.getElementById('app-title').textContent = appTitle;
      document.getElementById('transcript').placeholder = inputPlaceholder;
      document.getElementById('generate-btn').textContent = generateButtonText;
      
      const emptyState = document.getElementById('empty-state');
      if (emptyState) {
        emptyState.textContent = emptyStateText;
      }
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["app_title", config.app_title || defaultConfig.app_title],
        ["input_placeholder", config.input_placeholder || defaultConfig.input_placeholder],
        ["generate_button_text", config.generate_button_text || defaultConfig.generate_button_text],
        ["empty_state_text", config.empty_state_text || defaultConfig.empty_state_text]
      ]);
    }

    // Update word count
    function updateWordCount() {
      const text = document.getElementById('transcript').value;
      const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
      document.getElementById('word-count').textContent = `${words} word${words !== 1 ? 's' : ''}`;
    }

    // Update recording timer
    function updateTimer() {
      if (!recordingStartTime) return;
      const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
      const minutes = Math.floor(elapsed / 60);
      const seconds = elapsed % 60;
      const timerEl = document.querySelector('.recording-timer');
      if (timerEl) {
        timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
      }
    }

    // Initialize speech recognition
    function initSpeechRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      
      if (!SpeechRecognition) {
        showNotice('‚ö†Ô∏è Speech recognition is not supported in this environment. Please paste your transcript instead.', true);
        document.getElementById('record-btn').disabled = true;
        return false;
      }

      recognition = new SpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = 'en-US';
      recognition.maxAlternatives = 1;

      recognition.onstart = () => {
        isRecording = true;
        recordingStartTime = Date.now();
        const recordBtn = document.getElementById('record-btn');
        recordBtn.textContent = '‚èπÔ∏è Stop Recording';
        recordBtn.classList.add('recording');
        
        const statusEl = document.getElementById('recording-status');
        statusEl.innerHTML = 'Recording... <span class="recording-timer">0:00</span>';
        
        timerInterval = setInterval(updateTimer, 1000);
        
        const liveCaption = document.getElementById('live-caption');
        liveCaption.classList.add('active');
        
        const textarea = document.getElementById('transcript');
        textarea.classList.add('recording-active');
      };

      recognition.onresult = (event) => {
        let interimTranscript = '';
        let finalTranscript = '';

        for (let i = event.resultIndex; i < event.results.length; i++) {
          const transcript = event.results[i][0].transcript;
          if (event.results[i].isFinal) {
            finalTranscript += transcript + ' ';
          } else {
            interimTranscript += transcript;
          }
        }

        if (finalTranscript) {
          currentTranscript += finalTranscript;
          const textarea = document.getElementById('transcript');
          textarea.value = currentTranscript;
          updateWordCount();
        }

        // Update live caption with interim results
        const liveCaptionText = document.getElementById('live-caption-text');
        if (interimTranscript) {
          liveCaptionText.textContent = interimTranscript;
        } else if (finalTranscript) {
          liveCaptionText.textContent = finalTranscript.trim();
        }
      };

      recognition.onerror = (event) => {
        console.error('Speech recognition error:', event.error);
        
        if (event.error === 'not-allowed') {
          showNotice('üé§ Microphone access was denied. Please allow microphone access in your browser settings and try again.', true);
        } else if (event.error === 'no-speech') {
          showNotice('No speech detected. Please speak closer to your microphone.', false);
        } else if (event.error === 'aborted') {
          // Silent error, user stopped recording
        } else {
          showNotice(`Recording error: ${event.error}. This feature may not work in this environment.`, true);
        }
        
        stopRecording();
      };

      recognition.onend = () => {
        if (isRecording) {
          // Restart if still supposed to be recording
          try {
            recognition.start();
          } catch (e) {
            stopRecording();
          }
        }
      };

      return true;
    }

    function showNotice(message, persistent) {
      const notice = document.getElementById('mic-notice');
      notice.textContent = message;
      notice.style.display = 'block';
      
      if (!persistent) {
        setTimeout(() => {
          notice.style.display = 'none';
        }, 5000);
      }
    }

    function toggleRecording() {
      if (!recognition) {
        showNotice('Speech recognition is not available in this environment.', true);
        return;
      }

      if (isRecording) {
        stopRecording();
      } else {
        startRecording();
      }
    }

    function startRecording() {
      try {
        currentTranscript = document.getElementById('transcript').value;
        recognition.start();
      } catch (e) {
        showNotice('Could not start recording. Microphone access may be blocked.', true);
      }
    }

    function stopRecording() {
      isRecording = false;
      recordingStartTime = null;
      
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      
      if (recognition) {
        recognition.stop();
      }
      
      const recordBtn = document.getElementById('record-btn');
      recordBtn.textContent = 'üé§ Start Recording';
      recordBtn.classList.remove('recording');
      
      document.getElementById('recording-status').textContent = '';
      
      const liveCaption = document.getElementById('live-caption');
      liveCaption.classList.remove('active');
      
      const textarea = document.getElementById('transcript');
      textarea.classList.remove('recording-active');
    }

    function clearTranscript() {
      if (isRecording) {
        stopRecording();
      }
      document.getElementById('transcript').value = '';
      currentTranscript = '';
      updateWordCount();
      document.getElementById('live-caption-text').textContent = 'Listening...';
    }

    // Initialize SDKs
    async function init() {
      if (window.dataSdk) {
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) {
          console.error("Failed to initialize Data SDK");
        }
      }

      if (window.elementSdk) {
        await window.elementSdk.init({
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        });
      }

      // Initialize speech recognition
      initSpeechRecognition();
      
      // Initialize word count
      updateWordCount();
      
      // Add input listener for word count
      document.getElementById('transcript').addEventListener('input', updateWordCount);
    }

    // Process transcript into notes with auto-formatting
    function processTranscript(transcript) {
      // Split into sentences for better processing
      const sentences = transcript
        .replace(/([.!?])\s+/g, '$1|')
        .split('|')
        .map(s => s.trim())
        .filter(s => s.length > 10);
      
      const bullets = [];
      const actionItems = [];
      
      const actionKeywords = [
        'need to', 'needs to', 'have to', 'has to',
        'will', 'should', 'must', 'going to',
        'action item', 'todo', 'to do', 'task',
        'by friday', 'by monday', 'by tuesday', 'by wednesday', 'by thursday',
        'by next week', 'by end of', 'deadline',
        'follow up', 'followup', 'assign', 'responsible for',
        'let\'s', 'we should', 'i\'ll', 'i will'
      ];
      
      sentences.forEach(sentence => {
        // Clean up the sentence
        let cleaned = sentence
          .replace(/^(um|uh|like|so|well|okay|alright)\s+/gi, '')
          .replace(/\s+(um|uh|like)\s+/gi, ' ')
          .trim();
        
        // Capitalize first letter
        if (cleaned.length > 0) {
          cleaned = cleaned.charAt(0).toUpperCase() + cleaned.slice(1);
        }
        
        // Ensure proper ending punctuation
        if (!/[.!?]$/.test(cleaned)) {
          cleaned += '.';
        }
        
        const lowerSentence = cleaned.toLowerCase();
        const isAction = actionKeywords.some(keyword => lowerSentence.includes(keyword));
        
        if (isAction) {
          // Format action items more clearly
          let actionText = cleaned;
          
          // Extract who is responsible if mentioned
          const nameMatch = cleaned.match(/\b([A-Z][a-z]+)\s+(will|should|needs to|has to)/);
          if (nameMatch) {
            actionText = `${nameMatch[1]}: ${cleaned}`;
          }
          
          actionItems.push(actionText);
        } else {
          // Check if it's a key point (contains important keywords)
          const keyPointWords = ['important', 'key', 'main', 'critical', 'essential', 'decided', 'agreed', 'discussed'];
          const isKeyPoint = keyPointWords.some(word => lowerSentence.includes(word));
          
          if (isKeyPoint || cleaned.length > 20) {
            bullets.push(cleaned);
          }
        }
      });
      
      // Remove duplicates and very similar items
      const uniqueBullets = [...new Set(bullets)];
      const uniqueActions = [...new Set(actionItems)];
      
      return { 
        bullets: uniqueBullets.slice(0, 15), // Limit to top 15 points
        actionItems: uniqueActions.slice(0, 10) // Limit to top 10 actions
      };
    }

    // Render notes list
    function renderNotes() {
      const notesList = document.getElementById('notes-list');
      const emptyState = document.getElementById('empty-state');
      
      if (allNotes.length === 0) {
        emptyState.style.display = 'block';
        notesList.innerHTML = '';
        notesList.appendChild(emptyState);
        return;
      }
      
      emptyState.style.display = 'none';
      notesList.innerHTML = '';
      
      const sortedNotes = [...allNotes].sort((a, b) => 
        new Date(b.createdAt) - new Date(a.createdAt)
      );
      
      sortedNotes.forEach(note => {
        const noteCard = document.createElement('div');
        noteCard.className = 'note-card';
        
        const bullets = note.bullets ? note.bullets.split('|||').filter(b => b.trim()) : [];
        const actions = note.actionItems ? note.actionItems.split('|||').filter(a => a.trim()) : [];
        
        const date = new Date(note.createdAt);
        const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        
        noteCard.innerHTML = `
          <div class="note-header">
            <h3 class="note-title">${escapeHtml(note.title)}</h3>
            <button class="delete-btn" data-id="${note.__backendId}">Delete</button>
          </div>
          <div class="note-date">${dateStr}</div>
          
          ${bullets.length > 0 ? `
            <div class="note-section">
              <div class="section-label">Key Points</div>
              <ul class="bullet-list">
                ${bullets.map(b => `<li>${escapeHtml(b)}</li>`).join('')}
              </ul>
            </div>
          ` : ''}
          
          ${actions.length > 0 ? `
            <div class="note-section">
              <div class="section-label">Action Items</div>
              ${actions.map(a => `<div class="action-item">‚ö° ${escapeHtml(a)}</div>`).join('')}
            </div>
          ` : ''}
        `;
        
        notesList.appendChild(noteCard);
      });
      
      // Add delete handlers
      document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', handleDelete);
      });
    }

    // Handle delete
    async function handleDelete(e) {
      const backendId = e.target.dataset.id;
      const note = allNotes.find(n => n.__backendId === backendId);
      
      if (!note) return;
      
      e.target.disabled = true;
      e.target.textContent = 'Deleting...';
      
      const result = await window.dataSdk.delete(note);
      
      if (!result.isOk) {
        e.target.disabled = false;
        e.target.textContent = 'Delete';
        showToast('Failed to delete note. Please try again.', 'error');
      }
    }

    // Handle generate notes
    async function handleGenerate() {
      const title = document.getElementById('note-title').value.trim();
      const transcript = document.getElementById('transcript').value.trim();
      
      if (!transcript) {
        showToast('Please paste or record a transcript first!', 'error');
        return;
      }

      if (allNotes.length >= 999) {
        showToast('Maximum limit of 999 notes reached. Please delete some notes first.', 'error');
        return;
      }
      
      const generateBtn = document.getElementById('generate-btn');
      generateBtn.disabled = true;
      generateBtn.textContent = 'Processing...';
      
      const { bullets, actionItems } = processTranscript(transcript);
      
      const noteData = {
        id: Date.now().toString(),
        title: title || 'Untitled Meeting',
        transcript: transcript,
        bullets: bullets.join('|||'),
        actionItems: actionItems.join('|||'),
        createdAt: new Date().toISOString()
      };
      
      const result = await window.dataSdk.create(noteData);
      
      if (result.isOk) {
        document.getElementById('note-title').value = '';
        document.getElementById('transcript').value = '';
        currentTranscript = '';
        updateWordCount();
        showToast('‚úì Notes generated successfully!', 'success');
      } else {
        showToast('Failed to save notes. Please try again.', 'error');
      }
      
      generateBtn.disabled = false;
      generateBtn.textContent = window.elementSdk?.config?.generate_button_text || defaultConfig.generate_button_text;
    }

    function showToast(message, type) {
      const toast = document.createElement('div');
      const bgColor = type === 'success' ? '#48bb78' : '#fc8181';
      toast.style.cssText = `position: fixed; top: 20px; right: 20px; background: ${bgColor}; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 1000;`;
      toast.textContent = message;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Event listeners
    document.getElementById('record-btn').addEventListener('click', toggleRecording);
    document.getElementById('clear-btn').addEventListener('click', clearTranscript);
    document.getElementById('generate-btn').addEventListener('click', handleGenerate);

    // Initialize on load
    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a1939b8d54e6cda',t:'MTc2MzY1NTExMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
